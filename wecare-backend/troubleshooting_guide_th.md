# คู่มือแก้ไขปัญหาการเชื่อมต่อฐานข้อมูล (Database Connection Troubleshooting)

เนื่องจากระบบตรวจพบว่า **PostgreSQL** กำลังทำงานอยู่แต่ **ไม่สามารถเชื่อมต่อได้** เนื่องจากรหัสผ่านไม่ถูกต้อง (Error: `password authentication failed`) และระบบไม่สามารถรีเซ็ตรหัสผ่านให้ได้โดยอัตโนมัติ

กรุณาทำตามขั้นตอนดังนี้เพื่อแก้ไขปัญหา:

## วิธีที่ 1: ตรวจสอบรหัสผ่านใน pgAdmin (แนะนำ)
หากคุณติดตั้ง PostgreSQL แบบ Full Installation ปกติจะมีโปรแกรม **pgAdmin** ติดมาด้วย

1. เปิดโปรแกรม **pgAdmin 4**
2. ดับเบิลคลิกที่ Server `PostgreSQL 1x`
3. หากระบบถามรหัสผ่าน ให้ลองกรอกรหัสผ่านที่คุณอาจเคยตั้งไว้ (เช่น `admin`, `password`, `1234`, หรือ `root`)
4. เมื่อเข้าได้แล้ว ให้คลิกขวาที่ `Login/Group Roles` > `postgres` > `Properties`
5. ไปที่แท็บ `Definition` ใส่รหัสผ่านใหม่เป็น: `admin123`
6. กด **Save**
7. กลับมาที่ VS Code แล้วกดปุ่มดำเนินการต่อ

## วิธีที่ 2: แก้ไขไฟล์ pg_hba.conf (เพื่อปิดการถามรหัสผ่านชั่วคราว)
หากคุณจำรหัสผ่านไม่ได้เลย ให้ทำตามนี้:

1. ไปที่โฟลเดอร์ที่ติดตั้ง PostgreSQL (ปกติอยู่ที่ `C:\Program Files\PostgreSQL\1x\data`)
2. เปิดไฟล์ `pg_hba.conf` ด้วย Notepad (ต้องเปิดแบบ Run as Administrator)
3. เลื่อนลงไปล่างสุด หาบรรทัดที่เขียนว่า:
   ```
   IPv4 local connections:
   host    all             all             127.0.0.1/32            scram-sha-256
   ```
4. เปลี่ยนคำว่า `scram-sha-256` (หรือ `md5`) เป็น `trust`:
   ```
   host    all             all             127.0.0.1/32            trust
   ```
5. บันทึกไฟล์
6. รีสตาร์ท Service PostgreSQL (หรือรีสตาร์ทเครื่อง)
7. ระบบจะสามารถเชื่อมต่อได้โดยไม่ต้องใช้รหัสผ่าน

## วิธีที่ 3: ติดตั้งใหม่ (หากทำวิธีอื่นไม่ได้)
หากเป็นการติดตั้งเพื่อทดสอบ และไม่มีข้อมูลสำคัญ
1. ถอนการติดตั้ง PostgreSQL เดิม
2. ดาวน์โหลดและติดตั้งใหม่
3. **สำคัญ:** ตอนติดตั้ง ให้จดจำรหัสผ่านที่ตั้งไว้ (แนะนำให้ตั้งว่า `admin123` เพื่อให้ตรงกับค่าเริ่มต้นของโปรเจกต์)

---
**หมายเหตุ:** ไฟล์ `.env` ของโปรเจกต์ถูกตั้งค่าไว้ดังนี้:
```properties
DATABASE_URL=postgresql://postgres:admin123@localhost:5432/wecare
```
หากคุณตั้งรหัสผ่านเป็นอย่างอื่น กรุณามาแก้ไขในไฟล์ `.env` นี้ด้วย
